# Инструкция по использованию trio.js

## Оглавление

1. [Основные понятия](##-1.-Основные-понятия)
1. [Работа с фреймворком](##-2.-Работа-с-фреймворком)
1. [Примеры использования](##-3.-Примеры-использования)
1. [Описание системы](##-4.-Описание-системы)

## 1. Основные понятия

Разработка trio.js представляет собой микрофреймворк вводящий возможность использования однофайловых компонентов.

### 1.1 Возможности фреймворка

1. Объявление однофайловых компонентов - стили, код и разметку компонента можно объеденить в одном файле
1. Композиция компонентов - сложные кмпоненты могут состоять из нескольких простых
1. Повторное использование компонентов - однажды объявленный компонент можно использовать в одном проекте множество раз
1. Расширение компонентов
    * Компонент может иметь одну или несколько точек расширения
    * Реализация расширения так же может включать в себя новые точки расширения
1. Область действия стиля ограничена только дочерними элементами разметки

### 1.2 Преимущества фреймворка

1. Тестируемость - каждый компонент можно проинициализировать и протестировать отдельно
1. Отсутсвие дублирование кода - как результат повторного использования компонентов
1. Минимальный размер - менее 500 строк неминифицированного кода, это в свою очередь даёт
    * Быструю загрузку
    * Низкий порог входа для разработчиков
    * Возможность доработок фреймворка под конкретные задачи

### 1.3 Термины

1. **Тип контрола** - тип контрола, описание шаблонного элемента интерфейса, может расширяться и многократно использоватьсяв пределах проекта. Описывается в отдельном html-файле и содержит css-стили, html-разметку и js-код элемента. Имя контрола определяется именем файла.
1. **Слот расширения** - место расширения типа (может быть от 0 до бесконечности), определяется тегом `t-slot` и идентифицируется через атрибут `id` (если слот только один, то этот атрибут не обязателен)
1. **Имплементация расширения** - реализация точки расширения типа контрола, идентифицируется через класс `t-impl` и атрибут `id` равный `id` нужного слота (если слот только один, то для имплементации эти класс и атрибут не обязательны)
1. **Имплементация по умолчанию** - содержится внутри тега `t-slot`, используется при отсутсвии другой имплементации
1. **Блок контрола** - точка инстанцирования типа, определяется тегом `t` и атрибут `class` содерщащий тип контрола. Блок может содержать внутри себя информацию о имплементации
1. **Инстанс контрола** - экземпляр контрола, инстанциируется в блоке
1. **Компонент типа** *(или полуконтрол)* - инстансы контролов используемые внутри типа, до момента инстанциирования этого типа. С одной стороны имеет черты инстанса (например, может использоваться внутри типа несколько раз с различными имлементациями), а с другой - в момент инстанциирования родительского типа, должен быть так же проинстанциирован.

## 2. Работа с фреймворком

### 2.1 Объявление нового контрола

Для создания нового кмопнента необходимо:

1. Создать файл с именем `t-<имя компонента>.html`, который будет содержать описание компонента
2. В файле описать компонент как обычную HTML-страницу, но с указанием определённых `id` для кода, стилей, разметки и точек/мест возможного расширения компонента
    * `t-css` - стили контрола
    * `t-js` - логика контрола
    * `t-html` - разметка контрола
    * `t-slot` - точка возможного расширения контрола

### 2.2 Использования контрола

Тег для использования контрола:

* `t` - используется для объявления места использования контрола

Классы для использования контрола:

* `t-impl` - реализация точки расширения

## 3. Примеры использования

### 3.1 Объявление использования ранеее созданного компонента

1.Использование контрола t-mycontrol без точек расширения или с расширениеми по умолчанию:

```html
<t class="t-mycontrol"></t>
```

2.Использование контрола t-mycontrol имеющего одну точку (один slot) расширения:

```html
<t class="t-mycontrol">
    <div>Hello world!</div>
</t>
```

3.Использование контрола t-mycontrol имеющего несколько точек расширения - в этом случае для корневого элемента разметки необходимо указать, что это расширение (через присвоение класса `class="t-impl"`) и указать его имя (через атрибут `id`):

```html
<t class="t-mycontrol">
    <div class="t-impl" id="my-slot-1">Hello world!</div>
</t>
```

### 3.2 Создание нового компонента

1.Описание простейшего компонента (без стилей и логики):

```html
<!DOCTYPE html>
<html>
<head></head>
    <body>
        <div id="t-html">
            <div>My component</div>
        </div>
    </body>
</html>
```

2.Описание компонента со стилем:

```html
...
```

3.Описание компонента с точкой расширения:

```html
...
```

4.Описание компонента содержащего другой компонент:

```html
...
```

5.Описание компонента содержащего логику:

```html
...
```

## 4. Описание системы

### Описание ядра

Ядро системы состоит из следующих основных частей:

1. Функционала работы с типами (компонентами)
    * ...
1. Функционала работы с инстансами
    * ...
1. Вспомогательных функций
    * ...загрузка файлов и т.д.

### Особенности реализации

* Корневой элемент (BODY) является типом, но не имеет инстансов (так как всегда один). Тип корневого элемента нужен, так как он участвует в создании свои дочерних инстансов
* Каждому корневому элементу инстанса (t) присваивается уникальный ид состоящий из исходного ид, префикса t- и суффикса с порядковым номером инстанса. Это делает ид инстанса глобально уникальным
* **Важно!** Глобально уникальный ид инстанса присваивается в t, ещё до загрузки типа. Иначе (с учетом того, что загрузка идёт асинхронно), есть вероятность конфликтов значений ид
